<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Batteriestatus</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <main>
        <div class="batterie-status">
            <div class="batterie-status-bar">
                <p>Batterie 1</p>
                <div class="batterie-status-bar-stand batterie1"><span></span></div>
                <div><p class="batterie-status-bar-number batterie1-number"></p></div>
                <div><p class="batterie-voltage batterie1-voltage"></p></div>
            </div>
            <div class="batterie-status-bar">
                <p>Batterie 2</p>
                <div class="batterie-status-bar-stand batterie2"><span></span></div>
                <div><p class="batterie-status-bar-number batterie2-number"></p></div>
                <div><p class="batterie-voltage batterie2-voltage"></p></div>
            </div>
            <div class="batterie-status-bar">
                <p>Batterie 3</p>
                <div class="batterie-status-bar-stand batterie3"><span></span></div>
                <div><p class="batterie-status-bar-number batterie3-number"></p></div>
                <div><p class="batterie-voltage batterie3-voltage"></p></div>
            </div>
            <div class="batterie-status-bar">
                <p>Batterie 4</p>
                <div class="batterie-status-bar-stand batterie4"><span></span></div>
                <div><p class="batterie-status-bar-number batterie4-number"></p></div>
                <div><p class="batterie-voltage batterie4-voltage"></p></div>
            </div>
        </div>
        <div class="menu">
            <div class="menu-ctn">
                <img src="{{ url_for('static', filename='img/animation.gif') }}" alt="">
            </div>
        </div>
    </main>

    <footer>
        <div class="footer-logo">
            <img src="{{ url_for('static', filename='img/logo.svg') }}" alt="CC Logo">
        </div>
        <div class="footer-info">
            <h1>Informationen</h1>
        </div>
    </footer>

    <script type="text/javascript">
        document.addEventListener("DOMContentLoaded", function() {
            fetch('/battery_status')
                .then(response => response.json())
                .then(data => {
                    setstatus('batterie1', data.battery1.percentage, data.battery1.voltage);
                    setstatus('batterie2', data.battery2.percentage, data.battery2.voltage);
                    setstatus('batterie3', data.battery3.percentage, data.battery3.voltage);
                    setstatus('batterie4', data.battery4.percentage, data.battery4.voltage);
                })
                .catch(error => console.error('Error fetching battery data:', error));
        });

        function setstatus(className, status, voltage) {
            const batterieElement = document.getElementsByClassName(className)[0];
            const numberElement = document.getElementsByClassName(className + '-number')[0];
            const voltageElement = document.getElementsByClassName(className + '-voltage')[0];
            if (batterieElement) {
                batterieElement.style.width = `${status}%`;
            }
            if (numberElement) {
                numberElement.textContent = `Prozent: ${status.toFixed(2)}%`;
            }
            if (voltageElement) {
                voltageElement.textContent = `Spannung: ${voltage.toFixed(2)}V`;
            }
        }
    </script>
</body>
</html>
